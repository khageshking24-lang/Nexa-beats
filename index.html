<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexa Music | Hybrid 20s Fix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; overflow: hidden; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); }
        #lockScreen { background: #0f172a; position: fixed; inset: 0; z-index: 10000; display: none; align-items: center; justify-content: center; flex-direction: column; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="lockScreen">
        <div class="glass p-10 w-full max-w-sm text-center">
            <h2 class="text-2xl font-black mb-4">NEXA <span class="text-sky-400">SECURE</span></h2>
            <input type="text" id="musicKeyInput" placeholder="Enter Key" class="w-full p-4 rounded-xl bg-white/10 mb-4 outline-none text-center font-bold">
            <button onclick="unlockMusic()" class="w-full bg-sky-600 py-4 rounded-xl font-bold active:scale-95 transition">ACTIVATE</button>
            <p class="mt-4 text-[10px] text-slate-500 uppercase">Test Key: TEST-20</p>
        </div>
    </div>

    <div class="glass p-12 text-center w-full max-w-md">
        <div class="w-32 h-32 bg-sky-500/20 rounded-full mx-auto mb-6 flex items-center justify-center animate-pulse">
            <i class="fas fa-compact-disc text-5xl text-sky-400"></i>
        </div>
        <h2 class="text-xl font-bold">Nexa Music Active</h2>
        
        <div class="mt-4 p-4 bg-white/5 rounded-2xl border border-white/5">
            <h3 id="timerDisplay" class="text-2xl font-mono font-bold text-sky-400"></h3>
            <p id="statusLabel" class="text-[10px] text-slate-500 uppercase mt-1"></p>
        </div>

        <button id="upgradeBtn" onclick="forceUpgrade()" class="mt-6 text-[10px] text-sky-400 underline font-bold uppercase cursor-pointer">Upgrade to Permanent Access</button>
    </div>

    <script>
        // --- VAULT ---
        const MUSIC_KEYS = {
            "TEST-20": 20000, // 20 Seconds ONLY
            "MU-JAN26-XQ92B": 31 * 86400000,
            "Permanentkey63793119": "LIFETIME" // [cite: 2026-01-22]
        };

        let isUpgrading = false; // Flag to stop auto-redirect back to player

        function unlockMusic() {
            const key = document.getElementById('musicKeyInput').value.trim();
            if(MUSIC_KEYS[key]) {
                const duration = MUSIC_KEYS[key];
                const expiry = (duration === "LIFETIME") ? "PERMANENT" : Date.now() + duration;
                
                localStorage.setItem('mu_expiry', expiry);
                isUpgrading = false; // Reset flag
                alert(duration === "LIFETIME" ? "Success: Permanent Access! ðŸ‘‘" : "Success: 20 Seconds Active! ðŸš€");
                location.reload();
            } else { alert("Invalid Key!"); }
        }

        function forceUpgrade() {
            isUpgrading = true; // Tell system we are upgrading
            document.getElementById('lockScreen').style.display = 'flex';
        }

        function checkAccess() {
            if(isUpgrading) return; // Stop checking if user is on Upgrade screen

            const exp = localStorage.getItem('mu_expiry');
            const screen = document.getElementById('lockScreen');
            const timerUI = document.getElementById('timerDisplay');
            const statusUI = document.getElementById('statusLabel');
            const upBtn = document.getElementById('upgradeBtn');

            if(!exp) {
                screen.style.display = 'flex';
                return;
            }

            if(exp === "PERMANENT") {
                screen.style.display = 'none';
                timerUI.innerText = "LIFETIME ACCESS";
                statusUI.innerText = "Premium Verified";
                upBtn.style.display = 'none'; // Permanent users don't need upgrade button
            } else {
                const timeLeft = parseInt(exp) - Date.now();
                if(timeLeft <= 0) {
                    localStorage.removeItem('mu_expiry');
                    screen.style.display = 'flex';
                } else {
                    screen.style.display = 'none';
                    timerUI.innerText = Math.ceil(timeLeft/1000) + "s";
                    statusUI.innerText = "Trial Mode Active";
                }
            }
        }

        setInterval(checkAccess, 1000);
        checkAccess();
    </script>
</body>
</html>
